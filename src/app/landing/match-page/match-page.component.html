<app-header></app-header>

<main>
  <app-beagle-page></app-beagle-page>

  <div class="titulo-seccion">
    <h2>BeagleMatch</h2>
  </div>

  <div class="container">

    <!-- Mensaje para usuarios NO logueados -->
    <div class="mensaje-login" *ngIf="!isLoggedIn">
      <div class="mensaje-login-contenido">
        <img src="https://cdn-icons-png.flaticon.com/512/3064/3064197.png" alt="Login required" class="icono-login" />
        <p>‚ú® Por favor, <strong>inicia sesi√≥n</strong> para ver las mascotas disponibles. üê∂</p>
        <button routerLink="/inicio-sesion" class="btn-login">Iniciar Sesi√≥n</button>
      </div>
    </div>



    <!-- Todo lo siguiente se muestra solo si el usuario est√° logueado -->
    <ng-container *ngIf="isLoggedIn">
      <div class="resultados">
        <h2>Resultados ({{ mascotasFiltradas.length }})</h2>

        <div class="filtros-activos" *ngIf="filtros.raza || filtros.edadMin || filtros.edadMax || filtros.pesoMax">
          <span *ngIf="filtros.raza" class="tag">
            Raza: {{ filtros.raza }}
            <button (click)="eliminarFiltro('raza')">&times;</button>
          </span>
          <span *ngIf="filtros.edadMin !== null" class="tag">
            Edad Min: {{ filtros.edadMin }}
            <button (click)="eliminarFiltro('edadMin')">&times;</button>
          </span>
          <span *ngIf="filtros.edadMax !== null" class="tag">
            Edad Max: {{ filtros.edadMax }}
            <button (click)="eliminarFiltro('edadMax')">&times;</button>
          </span>
          <span *ngIf="filtros.pesoMax !== null" class="tag">
            Peso Max: {{ filtros.pesoMax }}
            <button (click)="eliminarFiltro('pesoMax')">&times;</button>
          </span>
        </div>

        <div *ngIf="mascotasFiltradas.length > 0; else noHayMascotas">
          <div *ngIf="mascotaActual" class="tarjeta-profesional">
            <img [src]="mascotaActual.foto" alt="Foto de {{ mascotaActual.nombre }}" class="foto-mascota" />
            <div class="info-mascota">
              <h3>{{ mascotaActual.nombre }}</h3>
              <div class="atributos-mascota">
                <div class="atributo">
                  <span class="etiqueta">Raza</span>
                  <span class="valor">{{ mascotaActual.raza }}</span>
                </div>
                <div class="atributo">
                  <span class="etiqueta">Edad</span>
                  <span class="valor">{{ mascotaActual.edad }} a√±os</span>
                </div>
                <div class="atributo">
                  <span class="etiqueta">Peso</span>
                  <span class="valor">{{ mascotaActual.peso }} kg</span>
                </div>
              </div>
              <div class="botones-tinder">
                <button class="btn-dislike" (click)="darDislike()">‚úñÔ∏è</button>
                <button class="btn-like" (click)="darLike()">‚ù§Ô∏è</button>
              </div>
            </div>
          </div>
        </div>

        
      <ng-template #noHayMascotas>
        <div class="no-mascotas-box">
          <span class="no-mascotas-icon">üê∂</span>
          <p class="no-mascotas-titulo">Sin resultados</p>
          <p class="no-mascotas-texto">Prueba cambiando los filtros</p>
        </div>
      </ng-template>

      </div>

      <div class="filtros">
        <h2>Filtros</h2>
        <form (ngSubmit)="aplicarFiltros()">

          <div class="form-group">
            <label>Raza:</label>
            <select [(ngModel)]="filtros.raza" name="raza">
              <option value="">Todas</option>
              <option value="Beagle">Beagle</option>
              <option value="Boxer">Boxer</option>
              <option value="Bulldog">Bulldog</option>
              <option value="Bulldog Franc√©s">Bulldog Franc√©s</option>
              <option value="Chihuahua">Chihuahua</option>
              <option value="D√°lmata">D√°lmata</option>
              <option value="Golden Retriever">Golden Retriever</option>
              <option value="Husky">Husky</option>
              <option value="Labrador">Labrador</option>
              <option value="Pastor Alem√°n">Pastor Alem√°n</option>
              <option value="Pastor Belga">Pastor Belga</option>
              <option value="Poodle">Poodle</option>
              <option value="Shiba Inu">Shiba Inu</option>
            </select>
          </div>

          <div class="form-group">
            <label>Edad M√≠nima:</label>
            <input type="number" [(ngModel)]="filtros.edadMin" name="edadMin" min="0" />
          </div>

          <div class="form-group">
            <label>Edad M√°xima:</label>
            <input type="number" [(ngModel)]="filtros.edadMax" name="edadMax" min="0" />
          </div>

          <div class="form-group">
            <label>Peso M√°ximo (kg):</label>
            <input type="number" [(ngModel)]="filtros.pesoMax" name="pesoMax" min="0" step="0.1" />
          </div>

          <div class="botones-filtro">
            <button class="btn-filtrar" type="submit">Filtrar</button>
            <button class="btn-limpiar" type="button" (click)="limpiarFiltros()">Limpiar filtros</button>
          </div>
        </form>
      </div>

      <div *ngIf="mascotasFavoritas.length > 0" class="match-container">
        <h3>üéâ ¬°Felicidades! Tu mascota est√° a punto de hacer match con estas mascotas:</h3>

        <div class="match-grid">
          <div *ngFor="let mascota of mascotasFavoritas" class="match-card">
            <img [src]="mascota.foto" alt="Foto de {{ mascota.nombre }}" class="match-photo" />
            <p class="match-name">{{ mascota.nombre }}</p>
          </div>
        </div>
      </div>
    </ng-container>

  </div>

</main>

<app-footer></app-footer>
