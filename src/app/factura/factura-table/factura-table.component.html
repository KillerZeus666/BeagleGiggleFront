<app-navegacion></app-navegacion>

<div class="facturas-container">
  <div class="facturas-header">
    <h2>Facturas Pendientes</h2>
    <div class="acciones">
      <button class="btn btn-primary" (click)="navegarAComprarServicios()">
        <i class="fas fa-hand-holding-medical"></i> Comprar Servicio
      </button>
      <button class="btn btn-primary" (click)="navegarAComprarMedicamentos()">
        <i class="fas fa-pills"></i> Comprar Medicamentos
      </button>
    </div>
  </div>

  <div class="table-responsive">
    <table class="facturas-table">
      <thead>
        <tr>
          <th width="50px">Sel.</th>
          <th>ID Factura</th>
          <th>Fecha</th>
          <th>Total</th>
          <th>Estado</th>
          <th>Método de Pago</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let factura of facturas" [class.disabled]="factura.pagada">
          <td>
            <label class="checkbox-container">
              <input type="checkbox"
                     [checked]="seleccionadas.has(factura.idFactura)"
                     (change)="toggleSeleccion(factura.idFactura)"
                     [disabled]="factura.pagada">
              <span class="checkmark"></span>
            </label>
          </td>
          <td>{{ factura.idFactura }}</td>
          <td>{{ factura.fechaHora | date:'dd/MM/yyyy HH:mm' }}</td>
          <td>{{ factura.total | currency:'USD':'symbol':'1.2-2' }}</td>
          <td>
            <span class="badge" [ngClass]="{
              'badge-success': factura.pagada,
              'badge-warning': !factura.pagada
            }">
              {{ factura.pagada ? 'Pagada' : 'Pendiente' }}
            </span>
          </td>
          <td>{{ factura.metododepago || 'No especificado' }}</td>
        </tr>
        <tr *ngIf="facturas.length === 0">
          <td colspan="6" class="no-results">No hay facturas pendientes</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="facturas-footer" *ngIf="seleccionadas.size > 0">
    <button class="btn btn-success" (click)="pagar()">
      <i class="fas fa-credit-card"></i> Pagar {{ seleccionadas.size }} factura(s) seleccionada(s)
    </button>
  </div>

  <div *ngIf="mensaje" class="alert" [ngClass]="{
    'alert-success': mensaje.includes('éxito'),
    'alert-danger': mensaje.includes('Error')
  }">
    {{ mensaje }}
  </div>
</div>
