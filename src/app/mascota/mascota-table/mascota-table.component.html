<app-navegacion></app-navegacion>

<div class="main" id="mainContent">
  <div class="topbar">
    <div class="toggle" id="menuToggle">
      <ion-icon name="menu-outline"></ion-icon>
    </div>
  </div>

  <div class="container-principal">
    <h1>Listado de Mascotas</h1>

    <div class="buscador">
      <input
        type="text"
        [(ngModel)]="nombreABuscar"
        placeholder="Buscar mascota..."
        class="input-busqueda"
      />
      <button (click)="buscar()" class="btn-buscar">Buscar</button>
    </div>

    <div class="button-container">
      <button (click)="abrirFormularioMascota()" class="btn-agregar">Crear Mascota</button>
    </div>

    <div class="tabla-container">
      <table class="tabla">
        <thead>
          <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Raza</th>
            <th>Edad</th>
            <th>Peso</th>
            <th>Enfermedad</th>
            <th>Foto</th>
            <th>Nacimiento</th>
            <th>Ingreso</th>
            <th>Salida</th>
            <th>Estado</th>
            <th>Cliente</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let mascota of mascotaList">
            <td>{{ mascota.idMascota }}</td>
            <td>{{ mascota.nombre }}</td>
            <td>{{ mascota.raza }}</td>
            <td>{{ mascota.edad }}</td>
            <td>{{ mascota.peso }}</td>
            <td>{{ mascota.enfermedad }}</td>
            <td>
              <img *ngIf="mascota.foto" [src]="mascota.foto" alt="Foto" class="foto-tabla">
            </td>
            <td>{{ mascota.fechaNacimiento | date:'yyyy/MM/dd' }}</td>
            <td>{{ mascota.fechaIngreso | date:'yyyy/MM/dd' }}</td>
            <td>{{ mascota.fechaSalida ? (mascota.fechaSalida | date:'yyyy/MM/dd') : '-' }}</td>
            <td>{{ mascota.estado === 1 ? 'Activo' : 'Inactivo' }}</td>
            <td>{{ mascota.cliente?.nombre }}</td>
            <td>
              <button class="btn-detalles" (click)="mostrarMascota(mascota.idMascota)">Detalles</button>
              <button  class="btn-editar" (click)="abrirFormularioMascotaEdicion(mascota.idMascota)">Editar</button>
              <button *ngIf="esAdmin()" class="btn-eliminar" (click)="eliminarMascota(mascota)">Eliminar</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
